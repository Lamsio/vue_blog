(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{478:function(e,t,a){"use strict";a.r(t);var n=a(4),s=Object(n.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h4",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[e._v("#")]),e._v(" 简介")]),e._v(" "),t("p",[e._v("在Java中，我们如果需要执行IO流操作就需要依赖"),t("code",[e._v("InputStream")]),e._v("和"),t("code",[e._v("OutputStream")]),e._v("。我们常用"),t("code",[e._v("FileInputStream")]),e._v("从文件中读取数据，我们也使用"),t("code",[e._v("ServletInputStream")]),e._v("从HTTP请求中获取数据，如果我们想从TCP连接中获取数据，也能使用"),t("code",[e._v("Socket.getInputStream()")]),e._v("获取对应数据。")]),e._v(" "),t("p",[e._v("但此时我们可能有需求，我们想为上述的InputStream添加各种附带功能，例如缓冲/数字签名/加密等等该怎么做到呢？")]),e._v(" "),t("p",[e._v("当我们需要给一个“基础”"),t("code",[e._v("InputStream")]),e._v("附加各种功能时，我们先确定这个能提供数据源的"),t("code",[e._v("InputStream")]),e._v("，因为我们需要的数据总得来自某个地方，例如，"),t("code",[e._v("FileInputStream")]),e._v("，数据来源自文件：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('InputStream file = new FileInputStream("test.gz");\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("紧接着，我们希望"),t("code",[e._v("FileInputStream")]),e._v("能提供缓冲的功能来提高读取的效率，因此我们用"),t("code",[e._v("BufferedInputStream")]),e._v("包装这个"),t("code",[e._v("InputStream")]),e._v("，得到的包装类型是"),t("code",[e._v("BufferedInputStream")]),e._v("，但它仍然被视为一个"),t("code",[e._v("InputStream")]),e._v("：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("InputStream buffered = new BufferedInputStream(file);\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("最后，假设该文件已经用gzip压缩了，我们希望直接读取解压缩的内容，就可以再包装一个"),t("code",[e._v("GZIPInputStream")]),e._v("：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("InputStream gzip = new GZIPInputStream(buffered);\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("无论我们包装多少次，得到的对象始终是"),t("code",[e._v("InputStream")]),e._v("，我们直接用"),t("code",[e._v("InputStream")]),e._v("来引用它，就可以正常读取：")]),e._v(" "),t("div",{staticClass:"language-ascii line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("┌─────────────────────────┐\n│GZIPInputStream          │\n│┌───────────────────────┐│\n││BufferedFileInputStream││\n││┌─────────────────────┐││\n│││   FileInputStream   │││\n││└─────────────────────┘││\n│└───────────────────────┘│\n└─────────────────────────┘\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br")])]),t("p",[e._v("上述这种通过一个“基础”组件再叠加各种“附加”功能组件的模式，称之为Filter模式（或者装饰器模式：Decorator）。它可以让我们通过少量的类来实现各种功能的组合：")]),e._v(" "),t("div",{staticClass:"language-ascii line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("                 ┌─────────────┐\n                 │ InputStream │\n                 └─────────────┘\n                       ▲ ▲\n┌────────────────────┐ │ │ ┌─────────────────┐\n│  FileInputStream   │─┤ └─│FilterInputStream│\n└────────────────────┘ │   └─────────────────┘\n┌────────────────────┐ │     ▲ ┌───────────────────┐\n│ByteArrayInputStream│─┤     ├─│BufferedInputStream│\n└────────────────────┘ │     │ └───────────────────┘\n┌────────────────────┐ │     │ ┌───────────────────┐\n│ ServletInputStream │─┘     ├─│  DataInputStream  │\n└────────────────────┘       │ └───────────────────┘\n                             │ ┌───────────────────┐\n                             └─│CheckedInputStream │\n                               └───────────────────┘\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br")])]),t("p",[e._v("类似的，"),t("code",[e._v("OutputStream")]),e._v("也是以这种模式来提供各种功能：")]),e._v(" "),t("div",{staticClass:"language-ascii line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("                  ┌─────────────┐\n                  │OutputStream │\n                  └─────────────┘\n                        ▲ ▲\n┌─────────────────────┐ │ │ ┌──────────────────┐\n│  FileOutputStream   │─┤ └─│FilterOutputStream│\n└─────────────────────┘ │   └──────────────────┘\n┌─────────────────────┐ │     ▲ ┌────────────────────┐\n│ByteArrayOutputStream│─┤     ├─│BufferedOutputStream│\n└─────────────────────┘ │     │ └────────────────────┘\n┌─────────────────────┐ │     │ ┌────────────────────┐\n│ ServletOutputStream │─┘     ├─│  DataOutputStream  │\n└─────────────────────┘       │ └────────────────────┘\n                              │ ┌────────────────────┐\n                              └─│CheckedOutputStream │\n                                └────────────────────┘\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br")])])])}),[],!1,null,null,null);t.default=s.exports}}]);